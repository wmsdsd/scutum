!function(c){"use strict";var t="kinetic-active";window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){window.setTimeout(t,1e3/60)}),c.support=c.support||{},c.extend(c.support,{touch:"ontouchend"in document});var n=function(t,e){return this.settings=e,this.el=t,this.$el=c(t),this._initElements(),this};n.DATA_KEY="kinetic",n.DEFAULTS={cursor:"move",decelerate:!0,triggerHardware:!1,threshold:0,y:!0,x:!0,slowdown:.9,maxvelocity:40,throttleFPS:60,invert:!1,movingClass:{up:"kinetic-moving-up",down:"kinetic-moving-down",left:"kinetic-moving-left",right:"kinetic-moving-right"},deceleratingClass:{up:"kinetic-decelerating-up",down:"kinetic-decelerating-down",left:"kinetic-decelerating-left",right:"kinetic-decelerating-right"}},n.prototype.start=function(t){this.settings=c.extend(this.settings,t),this.velocity=t.velocity||this.velocity,this.velocityY=t.velocityY||this.velocityY,this.settings.decelerate=!1,this._move()},n.prototype.end=function(){this.settings.decelerate=!0},n.prototype.stop=function(){this.velocity=0,this.velocityY=0,this.settings.decelerate=!0,c.isFunction(this.settings.stopped)&&this.settings.stopped.call(this)},n.prototype.detach=function(){this._detachListeners(),this.$el.removeClass(t).css("cursor","")},n.prototype.attach=function(){this.$el.hasClass(t)||(this._attachListeners(this.$el),this.$el.addClass(t).css("cursor",this.settings.cursor))},n.prototype.destroy=function(){this.detach(),this.$el=null,this.el=null,this.settings=null},n.prototype._initElements=function(){this.$el.addClass(t),c.extend(this,{xpos:null,prevXPos:!1,ypos:null,prevYPos:!1,mouseDown:!1,throttleTimeout:1e3/this.settings.throttleFPS,lastMove:null,elementFocused:null}),this.velocity=0,this.velocityY=0,c(document).mouseup(c.proxy(this._resetMouse,this)).click(c.proxy(this._resetMouse,this)),this._initEvents(),this.$el.css("cursor",this.settings.cursor),this.settings.triggerHardware&&this.$el.css({"-webkit-transform":"translate3d(0,0,0)","-webkit-perspective":"1000","-webkit-backface-visibility":"hidden"})},n.prototype._initEvents=function(){var s=this;this.settings.events={touchStart:function(t){var e;s._useTarget(t.target,t)&&(e=t.originalEvent.touches[0],s.threshold=s._threshold(t.target,t),s._start(e.clientX,e.clientY),t.stopPropagation())},touchMove:function(t){var e;s.mouseDown&&(e=t.originalEvent.touches[0],s._inputmove(e.clientX,e.clientY),t.preventDefault&&t.preventDefault())},inputDown:function(t){s._useTarget(t.target,t)&&(s.threshold=s._threshold(t.target,t),s._start(t.clientX,t.clientY),s.elementFocused=t.target,"IMG"===t.target.nodeName&&t.preventDefault(),t.stopPropagation())},inputEnd:function(t){s._useTarget(t.target,t)&&(s._end(),s.elementFocused=null,t.preventDefault&&t.preventDefault())},inputMove:function(t){s.mouseDown&&(s._inputmove(t.clientX,t.clientY),t.preventDefault&&t.preventDefault())},scroll:function(t){c.isFunction(s.settings.moved)&&s.settings.moved.call(s,s.settings),t.preventDefault&&t.preventDefault()},inputClick:function(t){if(0<Math.abs(s.velocity))return t.preventDefault(),!1},dragStart:function(t){if(s._useTarget(t.target,t)&&s.elementFocused)return!1},selectStart:function(t){return c.isFunction(s.settings.selectStart)?s.settings.selectStart.apply(s,arguments):!s._useTarget(t.target,t)&&void 0}},this._attachListeners(this.$el,this.settings)},n.prototype._inputmove=function(t,e){var s=this.$el;this.el;if((!this.lastMove||new Date>new Date(this.lastMove.getTime()+this.throttleTimeout))&&(this.lastMove=new Date,this.mouseDown&&(this.xpos||this.ypos))){var i=t-this.xpos,o=e-this.ypos;if(this.settings.invert&&(i*=-1,o*=-1),0<this.threshold){var n=Math.sqrt(i*i+o*o);if(this.threshold>n)return;this.threshold=0}this.elementFocused&&(c(this.elementFocused).blur(),this.elementFocused=null,s.focus()),this.settings.decelerate=!1,this.velocity=this.velocityY=0;var l=this.scrollLeft(),r=this.scrollTop();this.scrollLeft(this.settings.x?l-i:l),this.scrollTop(this.settings.y?r-o:r),this.prevXPos=this.xpos,this.prevYPos=this.ypos,this.xpos=t,this.ypos=e,this._calculateVelocities(),this._setMoveClasses(this.settings.movingClass),c.isFunction(this.settings.moved)&&this.settings.moved.call(this,this.settings)}},n.prototype._calculateVelocities=function(){this.velocity=this._capVelocity(this.prevXPos-this.xpos,this.settings.maxvelocity),this.velocityY=this._capVelocity(this.prevYPos-this.ypos,this.settings.maxvelocity),this.settings.invert&&(this.velocity*=-1,this.velocityY*=-1)},n.prototype._end=function(){this.xpos&&this.prevXPos&&!1===this.settings.decelerate&&(this.settings.decelerate=!0,this._calculateVelocities(),this.xpos=this.prevXPos=this.mouseDown=!1,this._move())},n.prototype._useTarget=function(t,e){return!c.isFunction(this.settings.filterTarget)||!1!==this.settings.filterTarget.call(this,t,e)},n.prototype._threshold=function(t,e){return c.isFunction(this.settings.threshold)?this.settings.threshold.call(this,t,e):this.settings.threshold},n.prototype._start=function(t,e){this.mouseDown=!0,this.velocity=this.prevXPos=0,this.velocityY=this.prevYPos=0,this.xpos=t,this.ypos=e},n.prototype._resetMouse=function(){this.xpos=!1,this.ypos=!1,this.mouseDown=!1},n.prototype._decelerateVelocity=function(t,e){return 0===Math.floor(Math.abs(t))?0:t*e},n.prototype._capVelocity=function(t,e){var s=t;return 0<t?e<t&&(s=e):t<0-e&&(s=0-e),s},n.prototype._setMoveClasses=function(t){var e=this.settings,s=this.$el;s.removeClass(e.movingClass.up).removeClass(e.movingClass.down).removeClass(e.movingClass.left).removeClass(e.movingClass.right).removeClass(e.deceleratingClass.up).removeClass(e.deceleratingClass.down).removeClass(e.deceleratingClass.left).removeClass(e.deceleratingClass.right),0<this.velocity&&s.addClass(t.right),this.velocity<0&&s.addClass(t.left),0<this.velocityY&&s.addClass(t.down),this.velocityY<0&&s.addClass(t.up)},n.prototype._move=function(){var t=this._getScroller()[0],e=this,s=e.settings;s.x&&0<t.scrollWidth?(this.scrollLeft(this.scrollLeft()+this.velocity),0<Math.abs(this.velocity)&&(this.velocity=s.decelerate?e._decelerateVelocity(this.velocity,s.slowdown):this.velocity)):this.velocity=0,s.y&&0<t.scrollHeight?(this.scrollTop(this.scrollTop()+this.velocityY),0<Math.abs(this.velocityY)&&(this.velocityY=s.decelerate?e._decelerateVelocity(this.velocityY,s.slowdown):this.velocityY)):this.velocityY=0,e._setMoveClasses(s.deceleratingClass),c.isFunction(s.moved)&&s.moved.call(this,s),0<Math.abs(this.velocity)||0<Math.abs(this.velocityY)?this.moving||(this.moving=!0,window.requestAnimationFrame(function(){e.moving=!1,e._move()})):e.stop()},n.prototype._getScroller=function(){var t=this.$el;return(this.$el.is("body")||this.$el.is("html"))&&(t=c(window)),t},n.prototype.scrollLeft=function(t){var e=this._getScroller();if("number"!=typeof t)return e.scrollLeft();e.scrollLeft(t),this.settings.scrollLeft=t},n.prototype.scrollTop=function(t){var e=this._getScroller();if("number"!=typeof t)return e.scrollTop();e.scrollTop(t),this.settings.scrollTop=t},n.prototype._attachListeners=function(){var t=this.$el,e=this.settings;c.support.touch&&t.bind("touchstart",e.events.touchStart).bind("touchend",e.events.inputEnd).bind("touchmove",e.events.touchMove),t.mousedown(e.events.inputDown).mouseup(e.events.inputEnd).mousemove(e.events.inputMove),t.click(e.events.inputClick).scroll(e.events.scroll).bind("selectstart",e.events.selectStart).bind("dragstart",e.events.dragStart)},n.prototype._detachListeners=function(){var t=this.$el,e=this.settings;c.support.touch&&t.unbind("touchstart",e.events.touchStart).unbind("touchend",e.events.inputEnd).unbind("touchmove",e.events.touchMove),t.unbind("mousedown",e.events.inputDown).unbind("mouseup",e.events.inputEnd).unbind("mousemove",e.events.inputMove),t.unbind("click",e.events.inputClick).unbind("scroll",e.events.scroll).unbind("selectstart",e.events.selectStart).unbind("dragstart",e.events.dragStart)},c.Kinetic=n,c.fn.kinetic=function(i,o){return this.each(function(){var t=c(this),e=t.data(n.DATA_KEY),s=c.extend({},n.DEFAULTS,t.data(),"object"==typeof i&&i);e||t.data(n.DATA_KEY,e=new n(this,s)),"string"==typeof i&&e[i](o)})}}(window.jQuery||window.Zepto);